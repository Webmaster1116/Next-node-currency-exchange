{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useContext } from 'react';\nimport Link from 'next/link';\nimport Cookies from 'js-cookie';\nimport Account from './AgentAccount';\nimport Axios from 'axios';\nimport AgentContext from '../../context/AgentContext';\nimport AlertContext from '../../context/alert/alertContext';\nimport Router from 'next/router';\nimport getAgentId from '../genericFunctions/getAgentId';\nimport getAgentData from '../genericFunctions/getAgentData';\nimport getAgentAccounts from '../genericFunctions/getAgentAccounts';\nimport BankList from '../../Data/BankList';\n\nvar addAccount = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(token, body, id) {\n    var header, res;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            console.log('agent token', token);\n            header = {\n              headers: {\n                'x-auth-token': token\n              }\n            };\n            _context.next = 4;\n            return Axios.post('https://api.moni.pe/api/agentaccounts/', body, header)[\"catch\"](function (err) {\n              return console.log(err);\n            });\n\n          case 4:\n            res = _context.sent;\n            return _context.abrupt(\"return\", res);\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function addAccount(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar BankAccounts = function BankAccounts(props) {\n  var alertContext = useContext(AlertContext);\n  var setAlert = alertContext.setAlert,\n      alerts = alertContext.alerts;\n\n  var _useState = useState(''),\n      banks = _useState[0],\n      setBanks = _useState[1];\n\n  var _useState2 = useState(false),\n      addBank = _useState2[0],\n      setAddBank = _useState2[1];\n\n  var _useState3 = useState(''),\n      agentid = _useState3[0],\n      setAgentid = _useState3[1];\n\n  var _useState4 = useState(''),\n      accountNumber = _useState4[0],\n      setAccountNumber = _useState4[1];\n\n  var _useState5 = useState(''),\n      nickname = _useState5[0],\n      setNickname = _useState5[1];\n\n  var _useState6 = useState(BankList[0]),\n      bankName = _useState6[0],\n      setBankName = _useState6[1];\n\n  var _useState7 = useState('Ahorros'),\n      type = _useState7[0],\n      setType = _useState7[1];\n\n  var _useState8 = useState('Soles'),\n      currencyType = _useState8[0],\n      setCurrencyType = _useState8[1];\n\n  var _useState9 = useState(''),\n      bankUser = _useState9[0],\n      setBankUser = _useState9[1];\n\n  var token = Cookies.get('agentToken');\n  console.log('token', token);\n\n  var init = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var agentId, agentData, res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return getAgentId(token);\n\n            case 3:\n              agentId = _context2.sent;\n              console.log('id', agentId);\n              setAgentid(agentId);\n              _context2.next = 8;\n              return getAgentData(token, agentId);\n\n            case 8:\n              agentData = _context2.sent;\n              console.log('data', agentData);\n              _context2.next = 12;\n              return getAgentAccounts(token, agentId);\n\n            case 12:\n              res = _context2.sent;\n              console.log('res', res);\n              setBanks(res);\n              _context2.next = 20;\n              break;\n\n            case 17:\n              _context2.prev = 17;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log('error', _context2.t0); // setAlert(\"Por favor inicie sesi√≥n para continuar\", \"danger\");\n              // Router.push(\"/login\");\n\n            case 20:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 17]]);\n    }));\n\n    return function init() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    init();\n  }, []);\n\n  var handleBankAdd = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n      var body, res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              e.preventDefault();\n              body = {\n                bankName: bankName.name,\n                bankShort: bankName[\"short\"],\n                accountNumber: accountNumber,\n                type: type,\n                nickname: nickname,\n                currency: currencyType,\n                purpose: 'Receive',\n                agent: agentid,\n                bankUser: bankUser\n              };\n              _context3.next = 4;\n              return addAccount(token, body);\n\n            case 4:\n              res = _context3.sent;\n              console.log(body);\n              window.location.reload();\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleBankAdd(_x4) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  if (banks === '') {\n    return __jsx(\"div\", {\n      className: \"page-loader\"\n    }, __jsx(\"div\", {\n      className: \"loader\"\n    }, \"Cargando...\"));\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"section\", {\n    className: \"jsx-1248976296\" + \" \" + 'page-section min-section pt-90 pb-20'\n  }, __jsx(\"form\", {\n    className: \"jsx-1248976296\" + \" \" + 'form-normal'\n  }, __jsx(\"div\", {\n    className: \"jsx-1248976296\" + \" \" + 'container align-left'\n  }, __jsx(\"div\", {\n    className: \"jsx-1248976296\" + \" \" + 'col-md-4 col-xs-12 mt-30 padding0'\n  }, __jsx(\"dl\", {\n    className: \"jsx-1248976296\" + \" \" + 'toggle'\n  }, __jsx(React.Fragment, null, __jsx(\"dt\", {\n    className: \"jsx-1248976296\"\n  }, __jsx(\"button\", {\n    onClick: function onClick(e) {\n      e.preventDefault();\n      setAddBank(!addBank);\n    },\n    className: \"jsx-1248976296\" + \" \" + 'btn btn-mod btn-border-w btn-circle btn-alerta'\n  }, __jsx(\"i\", {\n    className: \"jsx-1248976296\" + \" \" + 'fa fa-plus fa-2x'\n  }), \" A\\xF1adir nueva cuenta\")), __jsx(\"dd\", {\n    style: addBank ? {\n      display: 'block'\n    } : {\n      display: 'none'\n    },\n    className: \"jsx-1248976296\" + \" \" + 'mb-30'\n  }, __jsx(\"div\", {\n    className: \"jsx-1248976296\" + \" \" + 'container padding0'\n  }, __jsx(\"div\", {\n    className: \"jsx-1248976296\" + \" \" + 'col-md-4 col-xs-12 padding0'\n  }, __jsx(\"h5\", {\n    className: \"jsx-1248976296\" + \" \" + 'black bold mb-10'\n  }, \"Tipo de cuenta\"), __jsx(\"select\", {\n    onChange: function onChange(e) {\n      return setType(e.target.value);\n    },\n    className: \"jsx-1248976296\" + \" \" + 'input-sm'\n  }, __jsx(\"option\", {\n    value: 'Ahorros',\n    className: \"jsx-1248976296\"\n  }, \"Ahorros\"), __jsx(\"option\", {\n    value: 'Corriente',\n    className: \"jsx-1248976296\"\n  }, \"Corriente\")), __jsx(\"h5\", {\n    className: \"jsx-1248976296\" + \" \" + 'black bold mb-10 mt-20'\n  }, \"Moneda\"), __jsx(\"select\", {\n    onChange: function onChange(e) {\n      setCurrencyType(e.target.value);\n    },\n    className: \"jsx-1248976296\" + \" \" + 'input-sm'\n  }, __jsx(\"option\", {\n    value: 'Soles',\n    className: \"jsx-1248976296\"\n  }, \"Soles(S/.)\"), __jsx(\"option\", {\n    value: 'Dollars',\n    className: \"jsx-1248976296\"\n  }, \"Dollars($)\")), __jsx(\"h5\", {\n    className: \"jsx-1248976296\" + \" \" + 'black bold mb-10  mt-20'\n  }, \"Nombre para recordar mi cuenta\"), __jsx(\"input\", {\n    type: \"text\",\n    placeholder: \"BBVA Soles\",\n    pattern: \".{3,100}\",\n    value: nickname,\n    onChange: function onChange(e) {\n      setNickname(e.target.value);\n    },\n    className: \"jsx-1248976296\" + \" \" + 'input-sm'\n  })), __jsx(\"div\", {\n    className: \"jsx-1248976296\" + \" \" + 'col-md-1 col-xs-12 padding0'\n  }), __jsx(\"div\", {\n    className: \"jsx-1248976296\" + \" \" + 'col-md-6 col-xs-12 padding0'\n  }, __jsx(\"h5\", {\n    className: \"jsx-1248976296\" + \" \" + 'black bold mb-10  mt-20'\n  }, \"Banco\"), __jsx(\"select\", {\n    onChange: function onChange(e) {\n      setBankName(JSON.parse(e.target.value));\n    },\n    className: \"jsx-1248976296\" + \" \" + 'input-sm'\n  }, BankList.map(function (bank, index) {\n    return __jsx(\"option\", {\n      key: index,\n      value: JSON.stringify(bank),\n      className: \"jsx-1248976296\"\n    }, bank.name);\n  }), ' '), __jsx(\"h5\", {\n    className: \"jsx-1248976296\" + \" \" + 'black bold mb-10  mt-20'\n  }, \"N\\xFAmero de cuenta\"), __jsx(\"input\", {\n    type: \"text\",\n    placeholder: \"001101520200382495\",\n    pattern: \".{3,100}\",\n    value: accountNumber,\n    onChange: function onChange(e) {\n      setAccountNumber(e.target.value);\n    },\n    className: \"jsx-1248976296\" + \" \" + 'input-sm'\n  }), __jsx(\"h5\", {\n    className: \"jsx-1248976296\" + \" \" + 'black bold mb-10  mt-20'\n  }, \"Nombre de la cuenta bancaria\"), __jsx(\"input\", {\n    type: \"text\",\n    placeholder: \"Nombre\",\n    value: bankUser,\n    onChange: function onChange(e) {\n      setBankUser(e.target.value);\n    },\n    className: \"jsx-1248976296\" + \" \" + 'input-sm'\n  }), __jsx(\"div\", {\n    className: \"jsx-1248976296\" + \" \" + 'col-md-6 col-xs-12 mt-30 padding0'\n  }), __jsx(\"div\", {\n    className: \"jsx-1248976296\" + \" \" + 'col-md-6 col-xs-12 mt-30 padding0'\n  }, __jsx(\"a\", {\n    onClick: handleBankAdd,\n    className: \"jsx-1248976296\" + \" \" + 'btn btn-mod btn-color btn-large btn-circle'\n  }, __jsx(\"i\", {\n    className: \"jsx-1248976296\" + \" \" + 'fa fa-plus fa-2x'\n  }), \" A\\xF1adir\")))))))), __jsx(\"div\", {\n    className: \"jsx-1248976296\" + \" \" + 'col-sm-12 mb-xs-40 padding0 mt-30'\n  }, __jsx(\"dl\", {\n    className: \"jsx-1248976296\" + \" \" + 'toggle'\n  }, banks.map(function (bank, index) {\n    console.log('bank', bank);\n    return __jsx(React.Fragment, {\n      key: index\n    }, __jsx(Account, {\n      data: bank,\n      id: bank._id\n    }));\n  })))))), __jsx(_JSXStyle, {\n    id: \"1248976296\"\n  }, [\".min-section.jsx-1248976296{background:white;background-image:url('../images/bkg-neutro.jpg');background-attachment:fixed;background-repeat:no-repeat;background-size:cover;min-height:100vh;}\", \".btn-a.jsx-1248976296{background:transparent;color:#333;font-size:22px;font-weight:600;border:none;}\"]));\n};\n\nexport default BankAccounts;","map":null,"metadata":{},"sourceType":"module"}