{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useContext, useState, useEffect } from 'react';\nimport Cookies from 'js-cookie';\nimport Axios from 'axios';\nimport country_list from '../../Data/Country_List';\nimport AlertContext from '../../context/alert/alertContext';\nimport Router, { useRouter } from 'next/router';\nimport verifyMail from '../genericFunctions/verifyMail';\n\nvar Reg = function Reg(props) {\n  var router = useRouter();\n  var context = useContext(AlertContext);\n\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _useState2 = useState(['DNI', 'CE', 'Passport']),\n      docsList = _useState2[0];\n\n  var _useState3 = useState(false),\n      check = _useState3[0],\n      setCheck = _useState3[1];\n\n  var accType = props.profile.accType;\n  useEffect(function () {\n    window.onpopstate = function (event) {\n      window.location.href = '/';\n    };\n  }, []);\n\n  var handleRegister = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var _props$values, firstName, secondName, lastName, password, birthDate, email, phone, nationality, motherLastName, doctype, dni, accountType, body, res, token, header, body2, res1, sendMailbody;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n\n              if (!check) {\n                _context.next = 32;\n                break;\n              }\n\n              setLoading(true);\n              _props$values = props.values, firstName = _props$values.firstName, secondName = _props$values.secondName, lastName = _props$values.lastName, password = _props$values.password, birthDate = _props$values.birthDate, email = _props$values.email, phone = _props$values.phone, nationality = _props$values.nationality, motherLastName = _props$values.motherLastName, doctype = _props$values.doctype, dni = _props$values.dni, accountType = _props$values.accountType;\n              body = {\n                name: firstName,\n                email: email,\n                password: password\n              };\n              _context.prev = 5;\n              _context.next = 8;\n              return Axios.post('https://api.moni.pe/api/users', body);\n\n            case 8:\n              res = _context.sent;\n              token = res.data.token;\n              header = {\n                headers: {\n                  'x-auth-token': token\n                }\n              };\n              body2 = {\n                firstName: firstName,\n                secondName: secondName,\n                lastName: lastName,\n                birthDate: birthDate,\n                email: email,\n                phone: phone,\n                nationality: nationality,\n                doctype: doctype,\n                dni: dni,\n                accountType: props.profile,\n                motherLastName: motherLastName\n              };\n              _context.prev = 12;\n              _context.next = 15;\n              return Axios.post('https://api.moni.pe/api/profiles', body2, header);\n\n            case 15:\n              res1 = _context.sent;\n              sendMailbody = {\n                email: email\n              };\n              _context.next = 19;\n              return verifyMail(sendMailbody);\n\n            case 19:\n              _context.next = 24;\n              break;\n\n            case 21:\n              _context.prev = 21;\n              _context.t0 = _context[\"catch\"](12);\n              context.setAlert('Detalles de perfil no válidos', 'danger');\n\n            case 24:\n              // Cookies.set(\"token\", res.data.token);\n              // document.cookie = `type=${\"user\"};token=${res.data.token};path=/`;\n              // document.cookie = `token=${res.data.token};path=/`;\n              window.location.href = '/login';\n              setLoading(false);\n              _context.next = 32;\n              break;\n\n            case 28:\n              _context.prev = 28;\n              _context.t1 = _context[\"catch\"](5);\n              setLoading(false);\n              context.setAlert('Correo electrónico ya tomado', 'danger');\n\n            case 32:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 28], [12, 21]]);\n    }));\n\n    return function handleRegister(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  if (loading === true) {\n    return __jsx(\"div\", {\n      className: \"page-loader\"\n    }, __jsx(\"div\", {\n      className: \"loader\"\n    }, \"Cargando...\"));\n  }\n\n  return __jsx(\"section\", {\n    className: \"page-section pt-20 pb-0\"\n  }, __jsx(\"div\", {\n    className: \"home-content container\"\n  }, __jsx(\"div\", {\n    className: \"home-text\"\n  }, __jsx(\"div\", {\n    className: \"container align-center\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-sm-12 col\"\n  }, __jsx(\"form\", {\n    className: \"form white\"\n  }, __jsx(\"img\", {\n    src: \"images/logo-moni.png\",\n    alt: \"Moni\",\n    width: \"150px\"\n  }), __jsx(\"h1\", {\n    className: \"section-title pt-80 pt-xs-40 mb-40 mb-sm-40\"\n  }, \"Registro de usuario\"), __jsx(\"div\", {\n    className: \"col-md-4 mb-40 mb-xs-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"firstName\",\n    id: \"usuario\",\n    className: \"input-sm bold\",\n    placeholder: \"* Primer nomnbre\",\n    pattern: \".{3,100}\",\n    value: props.values.firstName,\n    onChange: props.handleChange('firstName')\n  })), __jsx(\"div\", {\n    className: \"col-md-4  mb-40  mb-xs-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"secondName\",\n    id: \"apellido1\",\n    className: \"input-sm bold\",\n    placeholder: \"Segundo nombre\",\n    pattern: \".{3,100}\",\n    value: props.values.secondName,\n    onChange: props.handleChange('secondName')\n  })), __jsx(\"div\", {\n    className: \"col-md-4 mb-40  mb-xs-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"lastName\",\n    id: \"apellido2\",\n    className: \"input-sm bold\",\n    placeholder: \"* Apellido paterno\",\n    pattern: \".{3,100}\",\n    value: props.values.lastName,\n    onChange: props.handleChange('lastName')\n  })), __jsx(\"div\", {\n    className: \"col-md-5 mb-20  mb-xs-0\"\n  }, __jsx(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    id: \"contrasena\",\n    className: \"input-sm bold\",\n    placeholder: \"* Contrase\\xF1a\",\n    pattern: \".{3,100}\",\n    value: props.values.password,\n    onChange: props.handleChange('password')\n  }), __jsx(\"i\", {\n    className: \"fa fa-eye fa-2x campoform\"\n  })), __jsx(\"div\", {\n    className: \"col-md-3 mb-20\"\n  }, __jsx(\"select\", {\n    className: \"input-sm form\",\n    onChange: props.handleChange('doctype'),\n    value: props.values.doctype\n  }, __jsx(\"option\", {\n    defaultValue: true\n  }, \"Tipo de documento\"), docsList.map(function (type, index) {\n    return __jsx(\"option\", {\n      className: \"li-cust\",\n      key: index,\n      value: type\n    }, type);\n  }))), __jsx(\"div\", {\n    className: \"col-md-4 mb-20  mb-xs-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"documento\",\n    id: \"documento\",\n    className: \"input-sm bold\",\n    placeholder: \"N\\xBA de documento\",\n    pattern: \".{3,100}\",\n    value: props.values.dni,\n    onChange: props.handleChange('dni')\n  })), __jsx(\"div\", {\n    className: \"col-md-8 mb-20\"\n  }, __jsx(\"select\", {\n    className: \"input-sm form\",\n    defaultValue: props.values.nationality,\n    onChange: props.handleChange('nationality')\n  }, __jsx(\"option\", {\n    defaultValue: true\n  }, \"Nacionalidad\"), country_list.map(function (country, index) {\n    return __jsx(\"option\", {\n      key: index,\n      value: country\n    }, country);\n  }))), __jsx(\"div\", {\n    className: \"col-md-4 mb-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"nacimiento\",\n    id: \"nacimiento\",\n    className: \"input-sm bold\",\n    placeholder: \"Fecha de nacimiento\",\n    pattern: \".{3,100}\",\n    value: props.profile,\n    disabled: true\n  })), __jsx(\"div\", {\n    className: \"col-md-4 mb-20 mb-xs-0\"\n  }, __jsx(\"input\", {\n    type: \"date\",\n    name: \"nacimiento\",\n    id: \"nacimiento\",\n    className: \"input-sm bold\",\n    placeholder: \"Fecha de nacimiento\",\n    pattern: \".{3,100}\",\n    value: props.values.birthDate,\n    onChange: props.handleChange('birthDate')\n  }), __jsx(\"i\", {\n    className: \"fa fa-calendar fa-2x campoform\"\n  })), __jsx(\"div\", {\n    className: \"col-md-3 mb-20  mb-xs-0\"\n  }, __jsx(\"input\", {\n    type: \"tel\",\n    name: \"tetefono\",\n    id: \"tetefono\",\n    className: \"input-sm bold\",\n    placeholder: \"N\\xFAmero telef\\xF3nico\",\n    pattern: \".{3,100}\",\n    value: props.values.phone,\n    onChange: props.handleChange('phone')\n  }), __jsx(\"i\", {\n    className: \"fa fa-phone fa-2x campoform\"\n  })), __jsx(\"div\", {\n    className: \"col-md-5 mb-20  mb-xs-0\"\n  }, __jsx(\"input\", {\n    type: \"email\",\n    name: \"email\",\n    id: \"email\",\n    className: \"input-sm bold\",\n    placeholder: \"Email\",\n    pattern: \".{3,100}\",\n    value: props.values.email,\n    onChange: props.handleChange('email')\n  }), __jsx(\"i\", {\n    className: \"fa fa-envelope fa-2x campoform\"\n  })), __jsx(\"div\", {\n    className: \"col-md-12 mb-20\"\n  }, __jsx(\"button\", {\n    className: \"btn btn-mod btn-color btn-border-w btn-large btn-circle mb-20\",\n    onClick: handleRegister\n  }, \"e Registrarme\")), __jsx(\"div\", {\n    className: \"col-md-12 mb-20\"\n  }, __jsx(\"a\", {\n    href: \"#\"\n  }, \"\\xBFOlvidaste tu contrase\\xF1a?\"), __jsx(\"p\", {\n    className: \"mt-20\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"inlineCheckbox1\",\n    value: check,\n    onChange: function onChange() {\n      return setCheck(!check);\n    }\n  }), ' ', \"Al registrarte, aceptas nuestros\", ' ', __jsx(\"a\", {\n    href: \"#\"\n  }, \"T\\xE9rminos y Condiciones\"), \" y\", ' ', __jsx(\"a\", {\n    href: \"#\"\n  }, \"Pol\\xEDticas de usos de Datos\"), \".\")))))))));\n};\n\nexport default Reg;","map":null,"metadata":{},"sourceType":"module"}