{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from 'react';\nimport { Table } from 'react-bootstrap';\nimport Axios from 'axios';\nimport Layout from '../../components/Admin/Layout';\nimport AlertContext from '../../context/alert/alertContext'; // import getAgents from \"../../components/genericFunctions/getAvailAgent\";\n\nimport Cookies from 'js-cookie';\nimport Navbar from '../../components/Admin/topNavbar';\nimport moment from 'moment';\n\nconst resetCommission = async (token, id) => {\n  const header = {\n    headers: {\n      'x-auth-token': token\n    }\n  };\n  const resAgent = await Axios.get('https://api.moni.pe/api/agent/reset/' + id, header);\n  return resAgent.data;\n};\n\nconst getInvoice = async token => {\n  const header = {\n    headers: {\n      'x-auth-token': token\n    }\n  };\n  const resAgent = await Axios.get('https://api.moni.pe/api/agent/invoice/', header);\n  return resAgent.data;\n};\n\nconst agentRegister = props => {\n  const {\n    0: state,\n    1: setState\n  } = useState([]);\n  const alertContext = useContext(AlertContext);\n  const {\n    setAlert,\n    alerts\n  } = alertContext;\n  const {\n    0: awaitData,\n    1: setAwaitData\n  } = useState(false);\n  const {\n    0: showPassword,\n    1: setShowPassword\n  } = useState(false);\n  const {\n    0: viewBankModal,\n    1: setViewBankModal\n  } = useState(false);\n  const {\n    0: popupBankData,\n    1: setPopupBankData\n  } = useState('');\n  const {\n    0: selectedAgentId,\n    1: setSelectedAgentId\n  } = useState('');\n  const token = Cookies.get('adminToken');\n  var today = new Date();\n  var nextweek = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 7);\n\n  const init = async () => {\n    const coo = Cookies.get('adminToken');\n\n    if (coo !== undefined) {\n      const data = await getInvoice(token);\n      setState(data);\n      console.log(data, 'agents');\n    } else {\n      window.location.href = '/admin_login';\n      setAlert('Inicie sesiÃ³n como administrador primero', 'danger');\n    }\n  };\n\n  useEffect(() => {\n    init();\n  }, []);\n\n  const handleSubmit = async id => {\n    await resetCommission(Cookies.get('adminToken'), id);\n    window.location.href = '/admin/invoice';\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Layout, null, __jsx(Navbar, null), __jsx(\"section\", {\n    className: \"jsx-1401856578\" + \" \" + 'page-section min-section pt-30 mt-40'\n  }, __jsx(\"div\", {\n    className: \"jsx-1401856578\" + \" \" + 'container min-section'\n  }, __jsx(\"div\", {\n    className: \"jsx-1401856578\" + \" \" + 'row mt-10 mb-30'\n  }), __jsx(\"div\", {\n    className: \"jsx-1401856578\" + \" \" + 'row'\n  }, __jsx(\"div\", {\n    className: \"jsx-1401856578\" + \" \" + 'col-md-12'\n  }, __jsx(Table, {\n    responsive: \"sm\",\n    className: \"table table-striped\"\n  }, __jsx(\"tbody\", {\n    className: \"jsx-1401856578\"\n  }, __jsx(\"tr\", {\n    className: \"jsx-1401856578\"\n  }, __jsx(\"th\", {\n    className: \"jsx-1401856578\" + \" \" + 'hidden-xs'\n  }), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"Agentes\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"Desde\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"Haste\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"USD\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"PEN\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"Estado\")), state.map((operation, index) => {\n    return __jsx(React.Fragment, {\n      key: index\n    }, __jsx(\"tr\", {\n      className: \"jsx-1401856578\"\n    }, __jsx(\"td\", {\n      className: \"jsx-1401856578\" + \" \" + 'hidden-xs'\n    }), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, __jsx(\"button\", {\n      onClick: async e => {\n        e.preventDefault(); // const res = await getAgentAccounts(\n        //   token,\n        //   operation._id\n        // );\n        // setPopupBankData(res);\n\n        setSelectedAgentId(operation._id);\n        setViewBankModal(!viewBankModal);\n      },\n      className: \"jsx-1401856578\" + \" \" + 'btn orange'\n    }, operation.name || '', ' ')), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, moment(operation.startDay).format('DD/MM/YYYY hh:mm')), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, moment(operation.endDay).format('DD/MM/YYYY hh:mm'), ' '), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, parseFloat(operation.commissionDollars).toFixed(4) || '0', ' ', ' $', ' '), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, parseFloat(operation.commissionSoles).toFixed(4) || '0', ' S./'), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, operation.commissionDollars == 0 && operation.commissionSoles == 0 ? __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, __jsx(\"div\", {\n      className: \"jsx-1401856578\" + \" \" + 'finalizado'\n    }, __jsx(\"i\", {\n      className: \"jsx-1401856578\" + \" \" + 'fa fa-lg  fa-exclamation-triangle'\n    }), ' ', 'Pagado'), ' ') : __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, __jsx(\"div\", {\n      className: \"jsx-1401856578\" + \" \" + 'pendiente'\n    }, __jsx(\"i\", {\n      className: \"jsx-1401856578\" + \" \" + 'fa fa-lg  fa-exclamation-triangle'\n    }), ' ', 'No pagado'), ' '))));\n  })))))), __jsx(_JSXStyle, {\n    id: \"1401856578\"\n  }, [\".min-section.jsx-1401856578{background:white;background-image:url('../images/bkg-neutro.jpg') !important;background-attachment:fixed;background-repeat:no-repeat;background-size:cover;}\", \".btn.jsx-1401856578{background:transparent;margin:0px;padding:0px;}\", \".min-section.jsx-1401856578{max-height:900vh;min-height:80vh;overflow:auto;white-space:nowrap;}\", \".page-section.jsx-1401856578{max-height:100vh;}\"]))));\n};\n\nexport default agentRegister;","map":null,"metadata":{},"sourceType":"module"}