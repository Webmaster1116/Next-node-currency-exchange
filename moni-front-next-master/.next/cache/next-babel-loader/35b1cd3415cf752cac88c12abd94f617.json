{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useContext, useState, useEffect } from 'react';\nimport Cookies from 'js-cookie';\nimport Axios from 'axios';\nimport country_list from '../../Data/Country_List';\nimport AlertContext from '../../context/alert/alertContext';\nimport Router, { useRouter } from 'next/router';\nimport verifyMail from '../genericFunctions/verifyMail';\n\nconst Reg = props => {\n  const router = useRouter();\n  const context = useContext(AlertContext);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: docsList\n  } = useState(['DNI', 'CE', 'Passport']);\n  const {\n    0: check,\n    1: setCheck\n  } = useState(false);\n  const {\n    accType\n  } = props.profile;\n  useEffect(() => {\n    window.onpopstate = function (event) {\n      window.location.href = '/';\n    };\n  }, []);\n\n  const handleRegister = async e => {\n    e.preventDefault();\n\n    if (check) {\n      setLoading(true);\n      const {\n        firstName,\n        secondName,\n        lastName,\n        password,\n        birthDate,\n        email,\n        phone,\n        nationality,\n        motherLastName,\n        doctype,\n        dni,\n        accountType\n      } = props.values;\n      const body = {\n        name: firstName,\n        email: email,\n        password: password\n      };\n\n      try {\n        const res = await Axios.post('https://api.moni.pe/api/users', body);\n        const token = res.data.token;\n        const header = {\n          headers: {\n            'x-auth-token': token\n          }\n        };\n        const body2 = {\n          firstName,\n          secondName,\n          lastName,\n          birthDate,\n          email,\n          phone,\n          nationality,\n          doctype,\n          dni,\n          accountType: props.profile,\n          motherLastName\n        };\n\n        try {\n          const res1 = await Axios.post('https://api.moni.pe/api/profiles', body2, header);\n          const sendMailbody = {\n            email: email\n          };\n          await verifyMail(sendMailbody);\n        } catch (error) {\n          context.setAlert('Detalles de perfil no válidos', 'danger');\n        } // Cookies.set(\"token\", res.data.token);\n        // document.cookie = `type=${\"user\"};token=${res.data.token};path=/`;\n        // document.cookie = `token=${res.data.token};path=/`;\n\n\n        window.location.href = '/login';\n        setLoading(false);\n      } catch (error) {\n        setLoading(false);\n        context.setAlert('Correo electrónico ya tomado', 'danger');\n      }\n    }\n  };\n\n  if (loading === true) {\n    return __jsx(\"div\", {\n      className: \"page-loader\"\n    }, __jsx(\"div\", {\n      className: \"loader\"\n    }, \"Cargando...\"));\n  }\n\n  return __jsx(\"section\", {\n    className: \"page-section pt-20 pb-0\"\n  }, __jsx(\"div\", {\n    className: \"home-content container\"\n  }, __jsx(\"div\", {\n    className: \"home-text\"\n  }, __jsx(\"div\", {\n    className: \"container align-center\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-sm-12 col\"\n  }, __jsx(\"form\", {\n    className: \"form white\"\n  }, __jsx(\"img\", {\n    src: \"images/logo-moni.png\",\n    alt: \"Moni\",\n    width: \"150px\"\n  }), __jsx(\"h1\", {\n    className: \"section-title pt-80 pt-xs-40 mb-40 mb-sm-40\"\n  }, \"Registro de usuario\"), __jsx(\"div\", {\n    className: \"col-md-4 mb-40 mb-xs-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"firstName\",\n    id: \"usuario\",\n    className: \"input-sm bold\",\n    placeholder: \"* Primer nomnbre\",\n    pattern: \".{3,100}\",\n    value: props.values.firstName,\n    onChange: props.handleChange('firstName')\n  })), __jsx(\"div\", {\n    className: \"col-md-4  mb-40  mb-xs-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"secondName\",\n    id: \"apellido1\",\n    className: \"input-sm bold\",\n    placeholder: \"Segundo nombre\",\n    pattern: \".{3,100}\",\n    value: props.values.secondName,\n    onChange: props.handleChange('secondName')\n  })), __jsx(\"div\", {\n    className: \"col-md-4 mb-40  mb-xs-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"lastName\",\n    id: \"apellido2\",\n    className: \"input-sm bold\",\n    placeholder: \"* Apellido paterno\",\n    pattern: \".{3,100}\",\n    value: props.values.lastName,\n    onChange: props.handleChange('lastName')\n  })), __jsx(\"div\", {\n    className: \"col-md-5 mb-20  mb-xs-0\"\n  }, __jsx(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    id: \"contrasena\",\n    className: \"input-sm bold\",\n    placeholder: \"* Contrase\\xF1a\",\n    pattern: \".{3,100}\",\n    value: props.values.password,\n    onChange: props.handleChange('password')\n  }), __jsx(\"i\", {\n    className: \"fa fa-eye fa-2x campoform\"\n  })), __jsx(\"div\", {\n    className: \"col-md-3 mb-20\"\n  }, __jsx(\"select\", {\n    className: \"input-sm form\",\n    onChange: props.handleChange('doctype'),\n    value: props.values.doctype\n  }, __jsx(\"option\", {\n    defaultValue: true\n  }, \"Tipo de documento\"), docsList.map((type, index) => {\n    return __jsx(\"option\", {\n      className: \"li-cust\",\n      key: index,\n      value: type\n    }, type);\n  }))), __jsx(\"div\", {\n    className: \"col-md-4 mb-20  mb-xs-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"documento\",\n    id: \"documento\",\n    className: \"input-sm bold\",\n    placeholder: \"N\\xBA de documento\",\n    pattern: \".{3,100}\",\n    value: props.values.dni,\n    onChange: props.handleChange('dni')\n  })), __jsx(\"div\", {\n    className: \"col-md-8 mb-20\"\n  }, __jsx(\"select\", {\n    className: \"input-sm form\",\n    defaultValue: props.values.nationality,\n    onChange: props.handleChange('nationality')\n  }, __jsx(\"option\", {\n    defaultValue: true\n  }, \"Nacionalidad\"), country_list.map((country, index) => {\n    return __jsx(\"option\", {\n      key: index,\n      value: country\n    }, country);\n  }))), __jsx(\"div\", {\n    className: \"col-md-4 mb-20\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"nacimiento\",\n    id: \"nacimiento\",\n    className: \"input-sm bold\",\n    placeholder: \"Fecha de nacimiento\",\n    pattern: \".{3,100}\",\n    value: props.profile,\n    disabled: true\n  })), __jsx(\"div\", {\n    className: \"col-md-4 mb-20 mb-xs-0\"\n  }, __jsx(\"input\", {\n    type: \"date\",\n    name: \"nacimiento\",\n    id: \"nacimiento\",\n    className: \"input-sm bold\",\n    placeholder: \"Fecha de nacimiento\",\n    pattern: \".{3,100}\",\n    value: props.values.birthDate,\n    onChange: props.handleChange('birthDate')\n  }), __jsx(\"i\", {\n    className: \"fa fa-calendar fa-2x campoform\"\n  })), __jsx(\"div\", {\n    className: \"col-md-3 mb-20  mb-xs-0\"\n  }, __jsx(\"input\", {\n    type: \"tel\",\n    name: \"tetefono\",\n    id: \"tetefono\",\n    className: \"input-sm bold\",\n    placeholder: \"N\\xFAmero telef\\xF3nico\",\n    pattern: \".{3,100}\",\n    value: props.values.phone,\n    onChange: props.handleChange('phone')\n  }), __jsx(\"i\", {\n    className: \"fa fa-phone fa-2x campoform\"\n  })), __jsx(\"div\", {\n    className: \"col-md-5 mb-20  mb-xs-0\"\n  }, __jsx(\"input\", {\n    type: \"email\",\n    name: \"email\",\n    id: \"email\",\n    className: \"input-sm bold\",\n    placeholder: \"Email\",\n    pattern: \".{3,100}\",\n    value: props.values.email,\n    onChange: props.handleChange('email')\n  }), __jsx(\"i\", {\n    className: \"fa fa-envelope fa-2x campoform\"\n  })), __jsx(\"div\", {\n    className: \"col-md-12 mb-20\"\n  }, __jsx(\"button\", {\n    className: \"btn btn-mod btn-color btn-border-w btn-large btn-circle mb-20\",\n    onClick: handleRegister\n  }, \"e Registrarme\")), __jsx(\"div\", {\n    className: \"col-md-12 mb-20\"\n  }, __jsx(\"a\", {\n    href: \"#\"\n  }, \"\\xBFOlvidaste tu contrase\\xF1a?\"), __jsx(\"p\", {\n    className: \"mt-20\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"inlineCheckbox1\",\n    value: check,\n    onChange: () => setCheck(!check)\n  }), ' ', \"Al registrarte, aceptas nuestros\", ' ', __jsx(\"a\", {\n    href: \"#\"\n  }, \"T\\xE9rminos y Condiciones\"), \" y\", ' ', __jsx(\"a\", {\n    href: \"#\"\n  }, \"Pol\\xEDticas de usos de Datos\"), \".\")))))))));\n};\n\nexport default Reg;","map":null,"metadata":{},"sourceType":"module"}