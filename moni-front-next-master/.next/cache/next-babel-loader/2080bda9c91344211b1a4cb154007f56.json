{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from 'react';\nimport { Table } from 'react-bootstrap';\nimport Axios from 'axios';\nimport AdminContext from '../../context/AdminContext';\nimport Layout from '../../components/Admin/Layout';\nimport Router, { withRouter } from 'next/router';\nimport AlertContext from '../../context/alert/alertContext';\nimport getAgents from '../../components/genericFunctions/getAvailAgent';\nimport Link from 'next/link';\nimport Head from 'next/head';\nimport Cookies from 'js-cookie';\nimport Navbar from '../../components/Admin/topNavbar';\nimport ViewBankPopup from '../../components/Admin/viewBankPopup';\nimport moment from 'moment';\nimport getAgentAccounts from '../../components/genericFunctions/getAgentAccounts';\nimport ViewAgentPopup from '../../components/Agents/viewAgentPopup';\nimport EditAgentPopup from '../../components/Agents/editAgentPopup';\n\nconst agentRegister = props => {\n  const {\n    0: state,\n    1: setState\n  } = useState([]); //   const { state, addToken, changeAuthenticated } = useContext(AdminContext);\n\n  const alertContext = useContext(AlertContext);\n  const {\n    setAlert,\n    alerts\n  } = alertContext;\n  const {\n    0: awaitData,\n    1: setAwaitData\n  } = useState(false);\n  const {\n    0: showPassword,\n    1: setShowPassword\n  } = useState(false);\n  const {\n    0: viewBankModal,\n    1: setViewBankModal\n  } = useState(false);\n  const {\n    0: popupBankData,\n    1: setPopupBankData\n  } = useState('');\n  const {\n    0: selectedAgentId,\n    1: setSelectedAgentId\n  } = useState('');\n  const {\n    0: viewAgentPopup,\n    1: setViewAgentPopup\n  } = useState(false);\n  const {\n    0: editAgentPopup,\n    1: setEditAgentPopup\n  } = useState(false);\n  const {\n    0: selectedAgent,\n    1: setSelectedAgent\n  } = useState('');\n  const token = Cookies.get('adminToken');\n\n  const init = async () => {\n    const coo = Cookies.get('adminToken');\n\n    if (coo !== undefined) {\n      const data = await getAgents(token);\n      setState(data);\n      console.log(data, 'agents');\n    } else {\n      window.location.href = '/admin_login';\n      setAlert('Admin Login First', 'danger');\n    }\n  };\n\n  useEffect(() => {\n    init();\n  }, []);\n\n  const handleEnable = async (e, id, prevStatus) => {\n    const newStatus = !prevStatus ? 'enable' : 'disable';\n    e.preventDefault();\n    console.log('enable called');\n    const header = {\n      headers: {\n        'x-auth-token': token\n      }\n    };\n    const res = await Axios.get('https://api.moni.pe/api/agent/' + newStatus + '/' + id, header);\n    console.log(res);\n    await init();\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Layout, null, __jsx(Navbar, null), __jsx(\"section\", {\n    className: \"jsx-2650147279\" + \" \" + 'page-section min-section pt-30 mt-40'\n  }, editAgentPopup ? __jsx(EditAgentPopup, {\n    setEditAgentPopup: setEditAgentPopup,\n    agent: selectedAgent,\n    token: true,\n    id: selectedAgentId\n  }) : '', __jsx(\"div\", {\n    className: \"jsx-2650147279\" + \" \" + 'container min-section'\n  }, __jsx(\"div\", {\n    className: \"jsx-2650147279\" + \" \" + 'row mt-10 mb-30'\n  }), __jsx(\"div\", {\n    className: \"jsx-2650147279\" + \" \" + 'row'\n  }, __jsx(\"div\", {\n    className: \"jsx-2650147279\" + \" \" + 'col-md-12'\n  }, __jsx(Table, {\n    responsive: \"sm\",\n    className: \"table table-striped\"\n  }, __jsx(\"tbody\", {\n    className: \"jsx-2650147279\"\n  }, __jsx(\"tr\", {\n    className: \"jsx-2650147279\"\n  }, __jsx(\"th\", {\n    className: \"jsx-2650147279\" + \" \" + 'hidden-xs'\n  }), __jsx(\"th\", {\n    className: \"jsx-2650147279\"\n  }, \"Nombre \"), __jsx(\"th\", {\n    className: \"jsx-2650147279\"\n  }, \"E-mail\"), __jsx(\"th\", {\n    className: \"jsx-2650147279\"\n  }, \"Soles de comisi\\xF3n\"), __jsx(\"th\", {\n    className: \"jsx-2650147279\"\n  }, \"D\\xF3lares de comisi\\xF3n\"), __jsx(\"th\", {\n    className: \"jsx-2650147279\"\n  }, \"N\\xFAmero de \", __jsx(\"br\", {\n    className: \"jsx-2650147279\"\n  }), \" operaciones\"), __jsx(\"th\", {\n    className: \"jsx-2650147279\"\n  }, \"Estado\"), __jsx(\"th\", {\n    className: \"jsx-2650147279\"\n  }, \"Acci\\xF3n\")), state.map((agent, index) => {\n    return __jsx(React.Fragment, {\n      key: index\n    }, viewBankModal ? __jsx(ViewBankPopup, {\n      setAvailBalanceOn: setViewBankModal,\n      data: agent,\n      token: token,\n      id: selectedAgentId\n    }) : '', viewAgentPopup ? __jsx(ViewAgentPopup, {\n      setViewAgentPopup: setViewAgentPopup,\n      agent: selectedAgent,\n      token: true,\n      id: selectedAgentId\n    }) : '', __jsx(\"tr\", {\n      className: \"jsx-2650147279\"\n    }, __jsx(\"td\", {\n      className: \"jsx-2650147279\" + \" \" + 'hidden-xs'\n    }, __jsx(\"input\", {\n      type: \"checkbox\",\n      checked: agent.enable,\n      onChange: e => handleEnable(e, agent._id, agent.enable),\n      className: \"jsx-2650147279\" + \" \" + 'form-check-input'\n    })), __jsx(\"td\", {\n      className: \"jsx-2650147279\"\n    }, __jsx(\"button\", {\n      onClick: async e => {\n        e.preventDefault(); // const res = await getAgentAccounts(\n        //   token,\n        //   agent._id\n        // );\n        // setPopupBankData(res);\n\n        setSelectedAgentId(agent._id);\n        setViewBankModal(!viewBankModal);\n      },\n      className: \"jsx-2650147279\" + \" \" + 'btn orange'\n    }, agent.name || '', ' ')), __jsx(\"td\", {\n      className: \"jsx-2650147279\"\n    }, agent.email || '', \" \"), __jsx(\"td\", {\n      className: \"jsx-2650147279\"\n    }, parseFloat(agent.commissionDollars).toFixed(4) || '0', ' ', ' $', ' '), __jsx(\"td\", {\n      className: \"jsx-2650147279\"\n    }, parseFloat(agent.commissionSoles).toFixed(4) || '0', ' S./'), __jsx(\"td\", {\n      className: \"jsx-2650147279\"\n    }, agent.length || '', \" \"), __jsx(\"td\", {\n      className: \"jsx-2650147279\"\n    }, agent.online ? 'En lÃ­nea' : 'Desconectado'), __jsx(\"td\", {\n      className: \"jsx-2650147279\"\n    }, __jsx(\"table\", {\n      className: \"jsx-2650147279\"\n    }, __jsx(\"tr\", {\n      className: \"jsx-2650147279\"\n    }, __jsx(\"td\", {\n      className: \"jsx-2650147279\" + \" \" + 'pr'\n    }, __jsx(\"button\", {\n      onClick: () => {\n        setSelectedAgent(agent);\n        setViewAgentPopup(!viewAgentPopup);\n        setEditAgentPopup(false);\n      },\n      className: \"jsx-2650147279\" + \" \" + 'btn'\n    }, __jsx(\"i\", {\n      className: \"jsx-2650147279\" + \" \" + 'fa fa-lg  fa-eye'\n    }))), __jsx(\"td\", {\n      className: \"jsx-2650147279\" + \" \" + 'pr'\n    }, __jsx(\"button\", {\n      onClick: () => {\n        setSelectedAgent(agent);\n        setEditAgentPopup(!editAgentPopup);\n        setViewAgentPopup(false);\n      },\n      className: \"jsx-2650147279\" + \" \" + 'btn'\n    }, __jsx(\"i\", {\n      className: \"jsx-2650147279\" + \" \" + 'fa fa-lg  fa-edit'\n    }))))))));\n  })))))), __jsx(_JSXStyle, {\n    id: \"2650147279\"\n  }, [\".min-section.jsx-2650147279{background:white;background-image:url('../images/bkg-neutro.jpg') !important;background-attachment:fixed;background-repeat:no-repeat;background-size:cover;}\", \".btn.jsx-2650147279{background:white;margin:0px;padding:0px;}\", \".min-section.jsx-2650147279{max-height:900vh;min-height:80vh;overflow:auto;white-space:nowrap;}\", \".page-section.jsx-2650147279{max-height:100vh;}\"]))));\n};\n\nexport default agentRegister;","map":null,"metadata":{},"sourceType":"module"}