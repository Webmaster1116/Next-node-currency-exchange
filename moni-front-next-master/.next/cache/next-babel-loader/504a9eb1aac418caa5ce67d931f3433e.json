{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from 'react';\nimport { Table } from 'react-bootstrap';\nimport Axios from 'axios';\nimport Layout from '../../components/Admin/Layout';\nimport AlertContext from '../../context/alert/alertContext'; // import getAgents from \"../../components/genericFunctions/getAvailAgent\";\n\nimport Cookies from 'js-cookie';\nimport Navbar from '../../components/Admin/topNavbar';\nimport moment from 'moment';\n\nvar resetCommission = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(token, id) {\n    var header, resAgent;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            header = {\n              headers: {\n                'x-auth-token': token\n              }\n            };\n            _context.next = 3;\n            return Axios.get('https://api.moni.pe/api/agent/reset/' + id, header);\n\n          case 3:\n            resAgent = _context.sent;\n            return _context.abrupt(\"return\", resAgent.data);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function resetCommission(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar getInvoice = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(token) {\n    var header, resAgent;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            header = {\n              headers: {\n                'x-auth-token': token\n              }\n            };\n            _context2.next = 3;\n            return Axios.get('https://api.moni.pe/api/agent/invoice/', header);\n\n          case 3:\n            resAgent = _context2.sent;\n            return _context2.abrupt(\"return\", resAgent.data);\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function getInvoice(_x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar agentRegister = function agentRegister(props) {\n  var _useState = useState([]),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var alertContext = useContext(AlertContext);\n  var setAlert = alertContext.setAlert,\n      alerts = alertContext.alerts;\n\n  var _useState2 = useState(false),\n      awaitData = _useState2[0],\n      setAwaitData = _useState2[1];\n\n  var _useState3 = useState(false),\n      showPassword = _useState3[0],\n      setShowPassword = _useState3[1];\n\n  var _useState4 = useState(false),\n      viewBankModal = _useState4[0],\n      setViewBankModal = _useState4[1];\n\n  var _useState5 = useState(''),\n      popupBankData = _useState5[0],\n      setPopupBankData = _useState5[1];\n\n  var _useState6 = useState(''),\n      selectedAgentId = _useState6[0],\n      setSelectedAgentId = _useState6[1];\n\n  var token = Cookies.get('adminToken');\n  var today = new Date();\n  var nextweek = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 7);\n\n  var init = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var coo, data;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              coo = Cookies.get('adminToken');\n\n              if (!(coo !== undefined)) {\n                _context3.next = 8;\n                break;\n              }\n\n              _context3.next = 4;\n              return getInvoice(token);\n\n            case 4:\n              data = _context3.sent;\n              setState(data); // console.log(data, 'agents');\n\n              _context3.next = 10;\n              break;\n\n            case 8:\n              window.location.href = '/admin_login';\n              setAlert('Inicie sesi√≥n como administrador primero', 'danger');\n\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function init() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    init();\n  }, []);\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return resetCommission(Cookies.get('adminToken'), id);\n\n            case 2:\n              window.location.href = '/admin/invoice';\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function handleSubmit(_x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, __jsx(Layout, null, __jsx(Navbar, null), __jsx(\"section\", {\n    className: \"jsx-1401856578\" + \" \" + 'page-section min-section pt-30 mt-40'\n  }, __jsx(\"div\", {\n    className: \"jsx-1401856578\" + \" \" + 'container min-section'\n  }, __jsx(\"div\", {\n    className: \"jsx-1401856578\" + \" \" + 'row mt-10 mb-30'\n  }), __jsx(\"div\", {\n    className: \"jsx-1401856578\" + \" \" + 'row'\n  }, __jsx(\"div\", {\n    className: \"jsx-1401856578\" + \" \" + 'col-md-12'\n  }, __jsx(Table, {\n    responsive: \"sm\",\n    className: \"table table-striped\"\n  }, __jsx(\"tbody\", {\n    className: \"jsx-1401856578\"\n  }, __jsx(\"tr\", {\n    className: \"jsx-1401856578\"\n  }, __jsx(\"th\", {\n    className: \"jsx-1401856578\" + \" \" + 'hidden-xs'\n  }), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"Agentes\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"Desde\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"Haste\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"USD\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"PEN\"), __jsx(\"th\", {\n    className: \"jsx-1401856578\"\n  }, \"Estado\")), state.map(function (operation, index) {\n    return __jsx(React.Fragment, {\n      key: index\n    }, __jsx(\"tr\", {\n      className: \"jsx-1401856578\"\n    }, __jsx(\"td\", {\n      className: \"jsx-1401856578\" + \" \" + 'hidden-xs'\n    }), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, __jsx(\"button\", {\n      onClick: /*#__PURE__*/function () {\n        var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e) {\n          return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n            while (1) {\n              switch (_context5.prev = _context5.next) {\n                case 0:\n                  e.preventDefault(); // const res = await getAgentAccounts(\n                  //   token,\n                  //   operation._id\n                  // );\n                  // setPopupBankData(res);\n\n                  setSelectedAgentId(operation._id);\n                  setViewBankModal(!viewBankModal);\n\n                case 3:\n                case \"end\":\n                  return _context5.stop();\n              }\n            }\n          }, _callee5);\n        }));\n\n        return function (_x5) {\n          return _ref5.apply(this, arguments);\n        };\n      }(),\n      className: \"jsx-1401856578\" + \" \" + 'btn orange'\n    }, operation.name || '', ' ')), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, moment(operation.startDay).format('DD/MM/YYYY hh:mm')), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, moment(operation.endDay).format('DD/MM/YYYY hh:mm'), ' '), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, parseFloat(operation.commissionDollars).toFixed(4) || '0', ' ', ' $', ' '), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, parseFloat(operation.commissionSoles).toFixed(4) || '0', ' S./'), __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, operation.commissionDollars == 0 && operation.commissionSoles == 0 ? __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, __jsx(\"div\", {\n      className: \"jsx-1401856578\" + \" \" + 'finalizado'\n    }, __jsx(\"i\", {\n      className: \"jsx-1401856578\" + \" \" + 'fa fa-lg  fa-exclamation-triangle'\n    }), ' ', 'Pagado'), ' ') : __jsx(\"td\", {\n      className: \"jsx-1401856578\"\n    }, __jsx(\"div\", {\n      className: \"jsx-1401856578\" + \" \" + 'pendiente'\n    }, __jsx(\"i\", {\n      className: \"jsx-1401856578\" + \" \" + 'fa fa-lg  fa-exclamation-triangle'\n    }), ' ', 'No pagado'), ' '))));\n  })))))), __jsx(_JSXStyle, {\n    id: \"1401856578\"\n  }, [\".min-section.jsx-1401856578{background:white;background-image:url('../images/bkg-neutro.jpg') !important;background-attachment:fixed;background-repeat:no-repeat;background-size:cover;}\", \".btn.jsx-1401856578{background:transparent;margin:0px;padding:0px;}\", \".min-section.jsx-1401856578{max-height:900vh;min-height:80vh;overflow:auto;white-space:nowrap;}\", \".page-section.jsx-1401856578{max-height:100vh;}\"]))));\n};\n\nexport default agentRegister;","map":null,"metadata":{},"sourceType":"module"}