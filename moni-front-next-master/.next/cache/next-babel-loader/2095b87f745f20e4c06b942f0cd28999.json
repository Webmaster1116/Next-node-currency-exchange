{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useContext, useState, useEffect } from 'react';\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport Logincontext from '../../context/LoginContext';\nimport UserContext from '../../context/UserContext';\nimport AlertContext from '../../context/alert/alertContext';\nimport { FaEye, FaEyeSlash } from 'react-icons/fa';\nimport Router, { withRouter } from 'next/router';\nimport Axios from 'axios';\nimport Link from 'next/link'; // import cookies from \"next-cookies\";\n\nimport Loader from '../Loader';\nimport Cookies from 'js-cookie';\nimport { NotificationContainer, NotificationManager } from 'react-notifications';\nimport { Route } from 'react-router-dom';\nimport { route } from 'next/dist/next-server/server/router';\nexport var Login = function Login() {\n  var _useState = useState(''),\n      username = _useState[0],\n      setUsername = _useState[1];\n\n  var _useState2 = useState(''),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  var context = useContext(Logincontext);\n\n  var _useContext = useContext(UserContext),\n      state = _useContext.state,\n      addToken = _useContext.addToken,\n      addName = _useContext.addName;\n\n  var alertContext = useContext(AlertContext);\n  var setAlert = alertContext.setAlert,\n      alerts = alertContext.alerts;\n\n  var _useState3 = useState(false),\n      awaitData = _useState3[0],\n      setAwaitData = _useState3[1];\n\n  var _useState4 = useState(false),\n      showPassword = _useState4[0],\n      setShowPassword = _useState4[1]; // useEffect(() => {\n  //   NotificationManager.info(\"Please login to continue\", \"Hola\");\n  // }, []);\n\n\n  var handleLogin = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var body, res, header, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              body = {\n                email: username,\n                password: password\n              };\n              setAwaitData(true);\n              _context.prev = 3;\n\n              if (!(body.email === '' || body.password === '')) {\n                _context.next = 9;\n                break;\n              }\n\n              setAlert('Por favor llena todos los espacios', 'danger');\n              setAwaitData(false);\n              _context.next = 22;\n              break;\n\n            case 9:\n              _context.next = 11;\n              return Axios.post('https://api.moni.pe/api/auth', body);\n\n            case 11:\n              res = _context.sent;\n              _context.next = 14;\n              return addToken(res.data.token);\n\n            case 14:\n              Cookies.set('token', res.data.token);\n              Router.push('/operation');\n              header = {\n                headers: {\n                  'x-auth-token': state.token\n                }\n              };\n              _context.next = 19;\n              return Axios.get('https://api.moni.pe/api/auth', header);\n\n            case 19:\n              data = _context.sent;\n              _context.next = 22;\n              return addName(data.data.name);\n\n            case 22:\n              _context.next = 29;\n              break;\n\n            case 24:\n              _context.prev = 24;\n              _context.t0 = _context[\"catch\"](3);\n\n              if (_context.t0.response.data.msg === 'Your account has not been verified.') {\n                Router.push('/resend');\n              }\n\n              setAlert(_context.t0.response.data.msg, 'danger');\n              setAwaitData(false);\n\n            case 29:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 24]]);\n    }));\n\n    return function handleLogin(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var togglePassword = function togglePassword(e) {\n    e.preventDefault();\n    setShowPassword(!showPassword);\n  };\n\n  if (awaitData === true) {\n    return __jsx(\"div\", {\n      className: \"form-container w-100 h-100\"\n    }, __jsx(\"div\", {\n      className: \"loader\"\n    }, __jsx(Loader, null)), __jsx(\"style\", null, \"\\n        .form-container {\\n          height: 100vh !important;\\n          // background: #071127;\\n          }\\n        \"));\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"register-container\"\n  }, __jsx(NotificationContainer, null), __jsx(\"h1\", null, \"Iniciar sesi\\xF3n\"), __jsx(\"form\", {\n    className: \"\"\n  }, __jsx(\"div\", {\n    className: \"form-row\"\n  }, __jsx(\"div\", {\n    className: \"input-group col-md-12 col-sm-12\"\n  }, __jsx(\"input\", {\n    className: \"form-control\",\n    type: \"email\",\n    placeholder: \"Correo electr\\xF3nico\",\n    value: username,\n    onChange: function onChange(e) {\n      setUsername(e.target.value);\n    }\n  })), __jsx(\"div\", {\n    className: \"input-group col-md-12 col-sm-12 mt-4\"\n  }, __jsx(\"input\", {\n    className: \"form-control form-icon\",\n    type: showPassword ? 'text' : 'password',\n    placeholder: \"Contrase\\xF1a\",\n    value: password,\n    onChange: function onChange(e) {\n      setPassword(e.target.value);\n    }\n  }), __jsx(\"button\", {\n    className: \"btn btn-icon input-group-addon\",\n    onClick: togglePassword\n  }, showPassword ? __jsx(FaEye, null) : __jsx(FaEyeSlash, null))), __jsx(\"label\", null, __jsx(\"button\", {\n    className: \"mt-3 btn forget\",\n    onClick: function onClick(e) {\n      e.preventDefault();\n      Router.push('/forgetpassword');\n    }\n  }, \"Forget password\"))), __jsx(\"button\", {\n    type: \"submit\",\n    className: \"login-btn btn btn-primary mt-4\",\n    onClick: handleLogin\n  }, \"Iniciar sesi\\xF3n\"), __jsx(Link, {\n    href: \"/admin_login\"\n  }, __jsx(\"button\", {\n    type: \"submit\",\n    className: \"login-btn btn btn-secondary\"\n  }, \"Administrador\"))), __jsx(\"style\", null, \"\\n          html {\\n            height: 100%;\\n            background-color: rgba(7, 17, 39, 1);\\n          }\\n          .register-container {\\n            text-align: center;\\n            margin: 100px auto;\\n            width: 400px;\\n            height: 450px;\\n            align-items: center;\\n            background-color: rgba(13, 27, 65, 0.9);\\n            // background: #071127;\\n            border-radius: 10px;\\n            padding: 50px;\\n            position: fixed;\\n            padding: 50px;\\n            left: 50%;\\n            top: 20%;\\n            transform: translate(-50%, -20%);\\n          }\\n          .form-group {\\n            padding: 5px !important ;\\n          }\\n          form {\\n            padding: 30px;\\n          }\\n          \\n          .login-btn {\\n            margin: 10px;\\n          }\\n          \\n          .loader {\\n            textt-align: center\\n          }\\n        \\n          .form-container {\\n            background: #071127;\\n          }\\n          .btn {\\n            color: white;\\n          }\\n          .btn-icon , .btn-icon:hover {\\n            color: black;\\n            position: relative;\\n            background: white;\\n            border: none;\\n            border-top-left-radius: 0px;\\n            border-bottom-left-radius: 0px;\\n          }\\n          .form-icon {\\n            border-right: none;\\n          }\\n\\n          .forget , .forget:hover {\\n            color: white;\\n            text-align: left;\\n            font-size: 0.75em;\\n          }\\n        \")));\n};\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}