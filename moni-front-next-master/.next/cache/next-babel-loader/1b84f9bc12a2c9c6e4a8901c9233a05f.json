{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from 'react';\nimport Cookies from 'js-cookie';\nimport getProfile from '../genericFunctions/getProfile';\nimport getAllTransactions from '../genericFunctions/getAllTransactions';\nimport loggedUser from '../genericFunctions/loggedUser';\nimport sendMail from '../genericFunctions/sendMail';\nimport Axios from 'axios';\nimport moment from 'moment';\nimport Hist from './HIstoryComp';\n\nvar History = function History(props) {\n  var token = Cookies.get('token');\n\n  var _useState = useState(false),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var _useState2 = useState(''),\n      profileDetails = _useState2[0],\n      setProfileDetails = _useState2[1];\n\n  var _useState3 = useState(false),\n      displayClass = _useState3[0],\n      setDisplay = _useState3[1];\n\n  var _useState4 = useState([]),\n      listClass = _useState4[0],\n      setListClass = _useState4[1];\n\n  var _useState5 = useState([]),\n      debug = _useState5[0],\n      setDebug = _useState5[1];\n\n  var _useState6 = useState(false),\n      loading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var _useState7 = useState(0),\n      savingsDollars = _useState7[0],\n      setSavingsDollars = _useState7[1];\n\n  var _useState8 = useState(0),\n      savingsSoles = _useState8[0],\n      setSavingsSoles = _useState8[1];\n\n  var dollarsName = 'DÃ³lares';\n\n  var init = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var id, user, data, t, t2, i, profile;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(false);\n\n              if (token === undefined) {\n                window.location.href = '/login';\n              }\n\n              _context.next = 4;\n              return loggedUser(token);\n\n            case 4:\n              id = _context.sent;\n              user = {\n                user: {\n                  id: id\n                }\n              };\n              console.log(user, 'xxxxxx');\n              _context.next = 9;\n              return getAllTransactions(token, user);\n\n            case 9:\n              data = _context.sent;\n              t = 0, t2 = 0;\n\n              for (i = 0; i < data.length; i++) {\n                console.log(data[i]);\n                if (data[i].transaction.currencyTo === 'Dollars' && data[i].transaction.status === 'Finalizado') t += parseFloat(data[i].transaction.savings) * parseFloat(data[i].transaction.exchange);else if (data[i].transaction.currencyTo === 'Soles' && data[i].transaction.status === 'Finalizado') t2 += parseFloat(data[i].transaction.savings);\n              }\n\n              console.log(t, ' t');\n              setSavingsDollars(t);\n              setSavingsSoles(t2);\n              _context.next = 17;\n              return getProfile(token);\n\n            case 17:\n              profile = _context.sent;\n              console.log(profile);\n              console.log(data);\n              console.log(debug);\n              setState(data);\n              setLoading(true);\n\n            case 23:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function init() {\n      return _ref.apply(this, arguments);\n    };\n  }(); // init();\n\n\n  useEffect(function () {\n    init();\n  }, []);\n\n  if (loading === false) {\n    return __jsx(\"div\", {\n      className: \"jsx-3868796514\" + \" \" + 'min-section'\n    }, __jsx(\"div\", {\n      className: \"jsx-3868796514\" + \" \" + 'loader'\n    }, \"Cargando...\"), __jsx(_JSXStyle, {\n      id: \"3868796514\"\n    }, [\".min-section.jsx-3868796514{background:white;background-image:url('images/bkg-neutro.jpg');background-attachment:fixed;background-repeat:no-repeat;background-size:cover;min-height:100vh;}\"]));\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"section\", {\n    className: \"jsx-812221516\" + \" \" + 'page-section bg-gray pb-10 pt-70'\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'relative container align-left'\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'row'\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'container'\n  }, __jsx(\"ul\", {\n    className: \"jsx-812221516\" + \" \" + 'nav nav-tabs tpl-tabs animate'\n  }, __jsx(\"li\", {\n    className: \"jsx-812221516\" + \" \" + 'active'\n  }, __jsx(\"a\", {\n    href: \"#one\",\n    \"data-toggle\": \"tab\",\n    \"aria-expanded\": \"true\",\n    className: \"jsx-812221516\"\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'alt-features-icon'\n  }, __jsx(\"i\", {\n    className: \"jsx-812221516\" + \" \" + 'fa fa-clock-o'\n  }), ' '), \"Pago pendiente\")), __jsx(\"li\", {\n    className: \"jsx-812221516\"\n  }, __jsx(\"a\", {\n    href: \"#two\",\n    \"data-toggle\": \"tab\",\n    \"aria-expanded\": \"false\",\n    className: \"jsx-812221516\"\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'alt-features-icon'\n  }, __jsx(\"i\", {\n    className: \"jsx-812221516\" + \" \" + 'fa fa-share'\n  })), \"Pago realizado\")), __jsx(\"li\", {\n    className: \"jsx-812221516\"\n  }, __jsx(\"a\", {\n    href: \"#three\",\n    \"data-toggle\": \"tab\",\n    \"aria-expanded\": \"false\",\n    className: \"jsx-812221516\"\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'alt-features-icon'\n  }, __jsx(\"i\", {\n    className: \"jsx-812221516\" + \" \" + 'fa fa-check-circle'\n  })), \"Finalizado\")), __jsx(\"li\", {\n    className: \"jsx-812221516\"\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'alt-service-item black mt-30'\n  }, \"S/\", __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'count-number orange'\n  }, parseFloat(savingsSoles + savingsDollars).toFixed(2), '  '), __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'count-descr'\n  }, __jsx(\"h3\", {\n    className: \"jsx-812221516\" + \" \" + 'bold mt-0 mb-0'\n  }, \"Ahorro acumulado\"))))))))), __jsx(\"section\", {\n    className: \"jsx-812221516\" + \" \" + 'page-section pt-0 pb-20 min-section'\n  }, __jsx(\"form\", {\n    className: \"jsx-812221516\" + \" \" + 'form-normal'\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'container align-left'\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'col-sm-12 padding0'\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'tab-content tpl-tabs-cont section-text'\n  }, __jsx(\"div\", {\n    id: \"one\",\n    className: \"jsx-812221516\" + \" \" + 'tab-pane fade active in'\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'relative mb-xs-40'\n  }, __jsx(\"dl\", {\n    className: \"jsx-812221516\" + \" \" + 'toggle'\n  }, state.filter(function (op) {\n    return op.transaction.status === 'Pago pendiente';\n  }).map(function (operation, index) {\n    console.log(operation);\n    return __jsx(Hist, {\n      data: operation\n    });\n  })))), __jsx(\"div\", {\n    id: \"two\",\n    className: \"jsx-812221516\" + \" \" + 'tab-pane fade'\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'relative mb-xs-40'\n  }, __jsx(\"dl\", {\n    className: \"jsx-812221516\" + \" \" + 'toggle'\n  }, state.filter(function (op) {\n    return op.transaction.status === 'Pago realizado';\n  }).map(function (operation, index) {\n    console.log(operation);\n    return __jsx(Hist, {\n      data: operation\n    });\n  })))), __jsx(\"div\", {\n    id: \"three\",\n    className: \"jsx-812221516\" + \" \" + 'tab-pane fade'\n  }, __jsx(\"div\", {\n    className: \"jsx-812221516\" + \" \" + 'relative mb-xs-40'\n  }, __jsx(\"dl\", {\n    className: \"jsx-812221516\" + \" \" + 'toggle'\n  }, state.filter(function (op) {\n    return op.transaction.status === 'Finalizado';\n  }).map(function (operation, index) {\n    console.log(operation);\n    return __jsx(Hist, {\n      data: operation\n    });\n  }))))))))), __jsx(_JSXStyle, {\n    id: \"812221516\"\n  }, [\".min-section.jsx-812221516{background:white;background-image:url('images/bkg-neutro.jpg');background-attachment:fixed;background-repeat:no-repeat;background-size:cover;min-height:80vh;}\", \".btn-a.jsx-812221516{background:transparent;color:#333;font-size:22px;font-weight:600;border:none;}\"]));\n};\n\nexport default History;\n\nvar changeStatus = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(token, id, amountReceive, amountToPay, currencyTo, currencyFrom, status) {\n    var body, header, res;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            body = {\n              transaction: {\n                amountReceive: amountReceive,\n                amountToPay: amountToPay,\n                currencyTo: currencyTo,\n                currencyFrom: currencyFrom,\n                status: status\n              }\n            };\n            console.log(body, 'bodu');\n            header = {\n              headers: {\n                'x-auth-token': token\n              }\n            };\n            _context2.next = 5;\n            return Axios.put('https://api.moni.pe/api/operations/' + id, body, header);\n\n          case 5:\n            res = _context2.sent;\n            console.log(res.data, 'EDited data');\n            return _context2.abrupt(\"return\", res.data);\n\n          case 8:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function changeStatus(_x, _x2, _x3, _x4, _x5, _x6, _x7) {\n    return _ref2.apply(this, arguments);\n  };\n}();","map":null,"metadata":{},"sourceType":"module"}